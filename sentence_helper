Submenu1 := {"1-hotmail"    : "_hotmail"
            ,"2-gmail"	    : "_gmail"}

Submenu2 := {"3-protonmail" : "_protonmail"}

For k, menuName in ["Submenu1", "Submenu2"]
	For menuItem, string in %menuName%
  		Menu, %menuName%, Add, %menuItem%, MenuHandler

Menu, MyMenu, Add, My Submenu1, :Submenu1
Menu, MyMenu, Add, My Submenu2, :Submenu2
;Menu, MyMenu, Add, My Submenu, :Submenu3
;Menu, MyMenu, Add, My Submenu, :Submenu4
;Menu, MyMenu, Add, My Submenu, :Submenu5


MenuHandler:
ReadSentence(%A_ThisMenu%[A_ThisMenuItem])
Return


ReadSentence(trigger)
{
	input_file = sentences.txt

	Loop, read, %input_file%
	{
		if InStr(A_LoopReadLine, trigger)
		{
			line_no := A_Index + 1
			break
		}
	}
	FileReadLine, line, %input_file%, %line_no%

	Clipboard := ParseSentence(line)
}

ParseSentence(string)
{
	replace := {"\n":"`r`n" 
	           ,"\t":"`t"}

	for x, y in replace
		string := StrReplace(string, x, y)

	return string
}

#z::Menu, MyMenu, Show
